<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Problem 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="HWProblem2_files/libs/clipboard/clipboard.min.js"></script>
<script src="HWProblem2_files/libs/quarto-html/quarto.js"></script>
<script src="HWProblem2_files/libs/quarto-html/popper.min.js"></script>
<script src="HWProblem2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HWProblem2_files/libs/quarto-html/anchor.min.js"></script>
<link href="HWProblem2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HWProblem2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HWProblem2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HWProblem2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HWProblem2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Problem 2</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="problem-2-application-problems" class="level2">
<h2 class="anchored" data-anchor-id="problem-2-application-problems">Problem 2: Application Problems</h2>
<p>Note that some details are missing for all the following exam-ples, the problems lack a complete explanation, and the codemay need adequate comments. In this form, you must presenta proper mathematical formulation, a brief background ofthe problem (and its bibliographical references) and, a muchbetter explanation.</p>
</section>
<section id="introduction-to-olsrr" class="level1">
<h1>Introduction to olsrr</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'olsrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    rivers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_regress</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Model Summary                          
--------------------------------------------------------------
R                       0.914       RMSE                2.622 
R-Squared               0.835       Coef. Var          13.051 
Adj. R-Squared          0.811       MSE                 6.875 
Pred R-Squared          0.771       MAE                 1.858 
--------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                               ANOVA                                 
--------------------------------------------------------------------
                Sum of                                              
               Squares        DF    Mean Square      F         Sig. 
--------------------------------------------------------------------
Regression     940.412         4        235.103    34.195    0.0000 
Residual       185.635        27          6.875                     
Total         1126.047        31                                    
--------------------------------------------------------------------

                                  Parameter Estimates                                    
----------------------------------------------------------------------------------------
      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper 
----------------------------------------------------------------------------------------
(Intercept)    27.330         8.639                  3.164    0.004     9.604    45.055 
       disp     0.003         0.011        0.055     0.248    0.806    -0.019     0.025 
         hp    -0.019         0.016       -0.212    -1.196    0.242    -0.051     0.013 
         wt    -4.609         1.266       -0.748    -3.641    0.001    -7.206    -2.012 
       qsec     0.544         0.466        0.161     1.166    0.254    -0.413     1.501 
----------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<section id="residual-vs-fitted-values-plot" class="level2">
<h2 class="anchored" data-anchor-id="residual-vs-fitted-values-plot"><strong>Residual vs Fitted Values Plot</strong></h2>
<p>Plot to detect non-linearity, unequal error variances, and outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="dfbetas-panel" class="level2">
<h2 class="anchored" data-anchor-id="dfbetas-panel"><strong>DFBETAs Panel</strong></h2>
<p>DFBETAs measure the difference in each parameter estimate with and without the influential observation. <code>dfbetas_panel</code> creates plots to detect influential observations using DFBETAs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_dfbetas</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="residual-fit-spread-plot" class="level2">
<h2 class="anchored" data-anchor-id="residual-fit-spread-plot"><strong>Residual Fit Spread Plot</strong></h2>
<p>Plot to detect non-linearity, influential observations and outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit_spread</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="breusch-pagan-test" class="level2">
<h2 class="anchored" data-anchor-id="breusch-pagan-test"><strong>Breusch Pagan Test</strong></h2>
<p>Breusch Pagan test is used to test for herteroskedasticity (non-constant error variance). It tests whether the variance of the errors from a regression is dependent on the values of the independent variables. It is a <span class="math inline">\(X^2\)</span> test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> drat, <span class="at">data =</span> mtcars)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

             Data               
 -------------------------------
 Response : mpg 
 Variables: fitted values of mpg 

       Test Summary         
 ---------------------------
 DF            =    1 
 Chi2          =    1.429672 
 Prob &gt; Chi2   =    0.231818 </code></pre>
</div>
</div>
</section>
<section id="collinearity-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="collinearity-diagnostics"><strong>Collinearity Diagnostics</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_coll_diag</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tolerance and Variance Inflation Factor
---------------------------------------
  Variables Tolerance      VIF
1      disp 0.1252279 7.985439
2        hp 0.1935450 5.166758
3        wt 0.1445726 6.916942
4      qsec 0.3191708 3.133119


Eigenvalue and Condition Index
------------------------------
   Eigenvalue Condition Index   intercept        disp          hp           wt
1 4.721487187        1.000000 0.000123237 0.001132468 0.001413094 0.0005253393
2 0.216562203        4.669260 0.002617424 0.036811051 0.027751289 0.0002096014
3 0.050416837        9.677242 0.001656551 0.120881424 0.392366164 0.0377028008
4 0.010104757       21.616057 0.025805998 0.777260487 0.059594623 0.7017528428
5 0.001429017       57.480524 0.969796790 0.063914571 0.518874831 0.2598094157
          qsec
1 0.0001277169
2 0.0046789491
3 0.0001952599
4 0.0024577686
5 0.9925403056</code></pre>
</div>
</div>
</section>
<section id="stepwise-regression" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-regression"><strong>Stepwise Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by entering and removing predictors based on p values, in a stepwise manner until there is no variable left to enter or remove any more.</p>
<section id="variable-selection" class="level3">
<h3 class="anchored" data-anchor-id="variable-selection"><strong>Variable Selection</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stepwise regression</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_p</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                Stepwise Selection Summary                                 
------------------------------------------------------------------------------------------
                        Added/                   Adj.                                         
Step     Variable      Removed     R-Square    R-Square     C(p)        AIC         RMSE      
------------------------------------------------------------------------------------------
   1    liver_test     addition       0.455       0.444    62.5120    771.8753    296.2992    
   2     alc_heavy     addition       0.567       0.550    41.3680    761.4394    266.6484    
   3    enzyme_test    addition       0.659       0.639    24.3380    750.5089    238.9145    
   4      pindex       addition       0.750       0.730     7.5370    735.7146    206.5835    
   5        bcs        addition       0.781       0.758     3.1920    730.6204    195.4544    
------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_both_p</span>(model)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="stepwise-aic-backward-regression" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-aic-backward-regression"><strong>Stepwise AIC Backward Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by removing predictors based on Akaike Information Criteria, in a stepwise manner until there is no variable left to remove any more.</p>
<section id="variable-selection-1" class="level3">
<h3 class="anchored" data-anchor-id="variable-selection-1"><strong>Variable Selection</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stepwise aic backward regression</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_backward_aic</span>(model)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                        Backward Elimination Summary                         
---------------------------------------------------------------------------
Variable        AIC          RSS          Sum Sq        R-Sq      Adj. R-Sq 
---------------------------------------------------------------------------
Full Model    736.390    1825905.713    6543614.824    0.78184      0.74305 
alc_mod       734.407    1826477.828    6543042.709    0.78177      0.74856 
gender        732.494    1829435.617    6540084.920    0.78142      0.75351 
age           730.620    1833716.447    6535804.090    0.78091      0.75808 
---------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_backward_aic</span>(model)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="variable-selection-methods" class="level1">
<h1><strong>Variable Selection Methods</strong></h1>
<section id="all-possible-regression" class="level2">
<h2 class="anchored" data-anchor-id="all-possible-regression"><strong>All Possible Regression</strong></h2>
<p>All subset regression tests all possible subsets of the set of potential independent variables. If there are K potential independent variables (besides the constant), then there are 2k2k distinct subsets of them to be tested. For example, if you have 10 candidate independent variables, the number of subsets to be tested is 210210, which is 1024, and if you have 20 candidate variables, the number is 220220, which is more than one million.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_all_possible</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Index N      Predictors  R-Square Adj. R-Square Mallow's Cp
3      1 1              wt 0.7528328     0.7445939   12.480939
1      2 1            disp 0.7183433     0.7089548   18.129607
2      3 1              hp 0.6024373     0.5891853   37.112642
4      4 1            qsec 0.1752963     0.1478062  107.069616
8      5 2           hp wt 0.8267855     0.8148396    2.369005
10     6 2         wt qsec 0.8264161     0.8144448    2.429492
6      7 2         disp wt 0.7809306     0.7658223    9.879096
5      8 2         disp hp 0.7482402     0.7308774   15.233115
7      9 2       disp qsec 0.7215598     0.7023571   19.602810
9     10 2         hp qsec 0.6368769     0.6118339   33.472150
14    11 3      hp wt qsec 0.8347678     0.8170643    3.061665
11    12 3      disp hp wt 0.8268361     0.8082829    4.360702
13    13 3    disp wt qsec 0.8264170     0.8078189    4.429343
12    14 3    disp hp qsec 0.7541953     0.7278591   16.257790
15    15 4 disp hp wt qsec 0.8351443     0.8107212    5.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_all_possible</span>(model)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in
ggplot2 3.3.4.
ℹ Please use "none" instead.
ℹ The deprecated feature was likely used in the olsrr package.
  Please report the issue at &lt;https://github.com/rsquaredacademy/olsrr/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="best-subset-regression" class="level2">
<h2 class="anchored" data-anchor-id="best-subset-regression"><strong>Best Subset Regression</strong></h2>
<p>Select the subset of predictors that do the best at meeting some well-defined objective criterion, such as having the largest R2 value or the smallest MSE, Mallow’s Cp or AIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_best_subset</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Best Subsets Regression    
------------------------------
Model Index    Predictors
------------------------------
     1         wt              
     2         hp wt           
     3         hp wt qsec      
     4         disp hp wt qsec 
------------------------------

                                                   Subsets Regression Summary                                                    
---------------------------------------------------------------------------------------------------------------------------------
                       Adj.        Pred                                                                                           
Model    R-Square    R-Square    R-Square     C(p)        AIC        SBIC        SBC         MSEP       FPE       HSP       APC  
---------------------------------------------------------------------------------------------------------------------------------
  1        0.7528      0.7446      0.7087    12.4809    166.0294    74.2916    170.4266    296.9167    9.8572    0.3199    0.2801 
  2        0.8268      0.8148      0.7811     2.3690    156.6523    66.5755    162.5153    215.5104    7.3563    0.2402    0.2091 
  3        0.8348      0.8171       0.782     3.0617    157.1426    67.7238    164.4713    213.1929    7.4756    0.2461    0.2124 
  4        0.8351      0.8107       0.771     5.0000    159.0696    70.0408    167.8640    220.8882    7.9497    0.2644    0.2259 
---------------------------------------------------------------------------------------------------------------------------------
AIC: Akaike Information Criteria 
 SBIC: Sawa's Bayesian Information Criteria 
 SBC: Schwarz Bayesian Criteria 
 MSEP: Estimated error of prediction, assuming multivariate normality 
 FPE: Final Prediction Error 
 HSP: Hocking's Sp 
 APC: Amemiya Prediction Criteria </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_best_subset</span>(model)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stepwise-forward-regression" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-forward-regression"><strong>Stepwise Forward Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by entering predictors based on p values, in a stepwise manner until there is no variable left to enter any more. The model should include all the candidate predictor variables. If details is set to <code>TRUE</code>, each step is displayed.</p>
<section id="variable-selection-2" class="level3">
<h3 class="anchored" data-anchor-id="variable-selection-2"><strong>Variable Selection</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_forward_p</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                              Selection Summary                                
------------------------------------------------------------------------------
        Variable                     Adj.                                         
Step      Entered      R-Square    R-Square     C(p)        AIC         RMSE      
------------------------------------------------------------------------------
   1    liver_test       0.4545      0.4440    62.5119    771.8753    296.2992    
   2    alc_heavy        0.5667      0.5498    41.3681    761.4394    266.6484    
   3    enzyme_test      0.6590      0.6385    24.3379    750.5089    238.9145    
   4    pindex           0.7501      0.7297     7.5373    735.7146    206.5835    
   5    bcs              0.7809      0.7581     3.1925    730.6204    195.4544    
------------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_forward_p</span>(model)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_forward_p</span>(model, <span class="at">details =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Forward Selection Method    
---------------------------

Candidate Terms: 

1. bcs 
2. pindex 
3. enzyme_test 
4. liver_test 
5. age 
6. gender 
7. alc_mod 
8. alc_heavy 

We are selecting variables based on p value...


Forward Selection: Step 1 

- liver_test 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.674       RMSE                 296.299 
R-Squared               0.455       Coef. Var             42.202 
Adj. R-Squared          0.444       MSE                87793.232 
Pred R-Squared          0.386       MAE                  212.857 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    3804272.477         1    3804272.477    43.332    0.0000 
Residual      4565248.060        52      87793.232                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t       Sig        lower      upper 
-------------------------------------------------------------------------------------------
(Intercept)     15.191       111.869                 0.136    0.893    -209.290    239.671 
 liver_test    250.305        38.025        0.674    6.583    0.000     174.003    326.607 
-------------------------------------------------------------------------------------------



Forward Selection: Step 2 

- alc_heavy 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.753       RMSE                 266.648 
R-Squared               0.567       Coef. Var             37.979 
Adj. R-Squared          0.550       MSE                71101.387 
Pred R-Squared          0.487       MAE                  187.393 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    4743349.776         2    2371674.888    33.356    0.0000 
Residual      3626170.761        51      71101.387                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                    Parameter Estimates                                      
--------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
--------------------------------------------------------------------------------------------
(Intercept)     -5.069       100.828                 -0.050    0.960    -207.490    197.352 
 liver_test    234.597        34.491        0.632     6.802    0.000     165.353    303.841 
  alc_heavy    342.183        94.156        0.338     3.634    0.001     153.157    531.208 
--------------------------------------------------------------------------------------------



Forward Selection: Step 3 

- enzyme_test 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.812       RMSE                 238.914 
R-Squared               0.659       Coef. Var             34.029 
Adj. R-Squared          0.639       MSE                57080.128 
Pred R-Squared          0.567       MAE                  170.603 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5515514.136         3    1838504.712    32.209    0.0000 
Residual      2854006.401        50      57080.128                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                      
---------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
---------------------------------------------------------------------------------------------
(Intercept)    -344.559       129.156                 -2.668    0.010    -603.976    -85.141 
 liver_test     183.844        33.845        0.495     5.432    0.000     115.865    251.823 
  alc_heavy     319.662        84.585        0.315     3.779    0.000     149.769    489.555 
enzyme_test       6.263         1.703        0.335     3.678    0.001       2.843      9.683 
---------------------------------------------------------------------------------------------



Forward Selection: Step 4 

- pindex 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.866       RMSE                 206.584 
R-Squared               0.750       Coef. Var             29.424 
Adj. R-Squared          0.730       MSE                42676.744 
Pred R-Squared          0.669       MAE                  146.473 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6278360.060         4    1569590.015    36.779    0.0000 
Residual      2091160.477        49      42676.744                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                       
-----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
-----------------------------------------------------------------------------------------------
(Intercept)    -789.012       153.372                 -5.144    0.000    -1097.226    -480.799 
 liver_test     125.474        32.358        0.338     3.878    0.000       60.448     190.499 
  alc_heavy     359.875        73.754        0.355     4.879    0.000      211.660     508.089 
enzyme_test       7.548         1.503        0.404     5.020    0.000        4.527      10.569 
     pindex       7.876         1.863        0.335     4.228    0.000        4.133      11.620 
-----------------------------------------------------------------------------------------------



Forward Selection: Step 5 

- bcs 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------



No more variables to be added.

Variables Entered: 

+ liver_test 
+ alc_heavy 
+ enzyme_test 
+ pindex 
+ bcs 


Final Model Output 
------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                              Selection Summary                                
------------------------------------------------------------------------------
        Variable                     Adj.                                         
Step      Entered      R-Square    R-Square     C(p)        AIC         RMSE      
------------------------------------------------------------------------------
   1    liver_test       0.4545      0.4440    62.5119    771.8753    296.2992    
   2    alc_heavy        0.5667      0.5498    41.3681    761.4394    266.6484    
   3    enzyme_test      0.6590      0.6385    24.3379    750.5089    238.9145    
   4    pindex           0.7501      0.7297     7.5373    735.7146    206.5835    
   5    bcs              0.7809      0.7581     3.1925    730.6204    195.4544    
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="stepwise-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-regression-1"><strong>Stepwise Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by entering and removing predictors based on p values, in a stepwise manner until there is no variable left to enter or remove any more. The model should include all the candidate predictor variables. If details is set to <code>TRUE</code>, each step is displayed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stepwise regression</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_p</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                Stepwise Selection Summary                                 
------------------------------------------------------------------------------------------
                        Added/                   Adj.                                         
Step     Variable      Removed     R-Square    R-Square     C(p)        AIC         RMSE      
------------------------------------------------------------------------------------------
   1    liver_test     addition       0.455       0.444    62.5120    771.8753    296.2992    
   2     alc_heavy     addition       0.567       0.550    41.3680    761.4394    266.6484    
   3    enzyme_test    addition       0.659       0.639    24.3380    750.5089    238.9145    
   4      pindex       addition       0.750       0.730     7.5370    735.7146    206.5835    
   5        bcs        addition       0.781       0.758     3.1920    730.6204    195.4544    
------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_both_p</span>(model)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_p</span>(model, <span class="at">details =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method   
---------------------------

Candidate Terms: 

1. bcs 
2. pindex 
3. enzyme_test 
4. liver_test 
5. age 
6. gender 
7. alc_mod 
8. alc_heavy 

We are selecting variables based on p value...


Stepwise Selection: Step 1 

- liver_test added 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.674       RMSE                 296.299 
R-Squared               0.455       Coef. Var             42.202 
Adj. R-Squared          0.444       MSE                87793.232 
Pred R-Squared          0.386       MAE                  212.857 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    3804272.477         1    3804272.477    43.332    0.0000 
Residual      4565248.060        52      87793.232                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t       Sig        lower      upper 
-------------------------------------------------------------------------------------------
(Intercept)     15.191       111.869                 0.136    0.893    -209.290    239.671 
 liver_test    250.305        38.025        0.674    6.583    0.000     174.003    326.607 
-------------------------------------------------------------------------------------------



Stepwise Selection: Step 2 

- alc_heavy added 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.753       RMSE                 266.648 
R-Squared               0.567       Coef. Var             37.979 
Adj. R-Squared          0.550       MSE                71101.387 
Pred R-Squared          0.487       MAE                  187.393 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    4743349.776         2    2371674.888    33.356    0.0000 
Residual      3626170.761        51      71101.387                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                    Parameter Estimates                                      
--------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
--------------------------------------------------------------------------------------------
(Intercept)     -5.069       100.828                 -0.050    0.960    -207.490    197.352 
 liver_test    234.597        34.491        0.632     6.802    0.000     165.353    303.841 
  alc_heavy    342.183        94.156        0.338     3.634    0.001     153.157    531.208 
--------------------------------------------------------------------------------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.753       RMSE                 266.648 
R-Squared               0.567       Coef. Var             37.979 
Adj. R-Squared          0.550       MSE                71101.387 
Pred R-Squared          0.487       MAE                  187.393 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    4743349.776         2    2371674.888    33.356    0.0000 
Residual      3626170.761        51      71101.387                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                    Parameter Estimates                                      
--------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
--------------------------------------------------------------------------------------------
(Intercept)     -5.069       100.828                 -0.050    0.960    -207.490    197.352 
 liver_test    234.597        34.491        0.632     6.802    0.000     165.353    303.841 
  alc_heavy    342.183        94.156        0.338     3.634    0.001     153.157    531.208 
--------------------------------------------------------------------------------------------



Stepwise Selection: Step 3 

- enzyme_test added 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.812       RMSE                 238.914 
R-Squared               0.659       Coef. Var             34.029 
Adj. R-Squared          0.639       MSE                57080.128 
Pred R-Squared          0.567       MAE                  170.603 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5515514.136         3    1838504.712    32.209    0.0000 
Residual      2854006.401        50      57080.128                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                      
---------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
---------------------------------------------------------------------------------------------
(Intercept)    -344.559       129.156                 -2.668    0.010    -603.976    -85.141 
 liver_test     183.844        33.845        0.495     5.432    0.000     115.865    251.823 
  alc_heavy     319.662        84.585        0.315     3.779    0.000     149.769    489.555 
enzyme_test       6.263         1.703        0.335     3.678    0.001       2.843      9.683 
---------------------------------------------------------------------------------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.812       RMSE                 238.914 
R-Squared               0.659       Coef. Var             34.029 
Adj. R-Squared          0.639       MSE                57080.128 
Pred R-Squared          0.567       MAE                  170.603 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    5515514.136         3    1838504.712    32.209    0.0000 
Residual      2854006.401        50      57080.128                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                     Parameter Estimates                                      
---------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
---------------------------------------------------------------------------------------------
(Intercept)    -344.559       129.156                 -2.668    0.010    -603.976    -85.141 
 liver_test     183.844        33.845        0.495     5.432    0.000     115.865    251.823 
  alc_heavy     319.662        84.585        0.315     3.779    0.000     149.769    489.555 
enzyme_test       6.263         1.703        0.335     3.678    0.001       2.843      9.683 
---------------------------------------------------------------------------------------------



Stepwise Selection: Step 4 

- pindex added 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.866       RMSE                 206.584 
R-Squared               0.750       Coef. Var             29.424 
Adj. R-Squared          0.730       MSE                42676.744 
Pred R-Squared          0.669       MAE                  146.473 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6278360.060         4    1569590.015    36.779    0.0000 
Residual      2091160.477        49      42676.744                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                       
-----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
-----------------------------------------------------------------------------------------------
(Intercept)    -789.012       153.372                 -5.144    0.000    -1097.226    -480.799 
 liver_test     125.474        32.358        0.338     3.878    0.000       60.448     190.499 
  alc_heavy     359.875        73.754        0.355     4.879    0.000      211.660     508.089 
enzyme_test       7.548         1.503        0.404     5.020    0.000        4.527      10.569 
     pindex       7.876         1.863        0.335     4.228    0.000        4.133      11.620 
-----------------------------------------------------------------------------------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.866       RMSE                 206.584 
R-Squared               0.750       Coef. Var             29.424 
Adj. R-Squared          0.730       MSE                42676.744 
Pred R-Squared          0.669       MAE                  146.473 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6278360.060         4    1569590.015    36.779    0.0000 
Residual      2091160.477        49      42676.744                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                       
-----------------------------------------------------------------------------------------------
      model        Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
-----------------------------------------------------------------------------------------------
(Intercept)    -789.012       153.372                 -5.144    0.000    -1097.226    -480.799 
 liver_test     125.474        32.358        0.338     3.878    0.000       60.448     190.499 
  alc_heavy     359.875        73.754        0.355     4.879    0.000      211.660     508.089 
enzyme_test       7.548         1.503        0.404     5.020    0.000        4.527      10.569 
     pindex       7.876         1.863        0.335     4.228    0.000        4.133      11.620 
-----------------------------------------------------------------------------------------------



Stepwise Selection: Step 5 

- bcs added 

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------



No more variables to be added/removed.


Final Model Output 
------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                Stepwise Selection Summary                                 
------------------------------------------------------------------------------------------
                        Added/                   Adj.                                         
Step     Variable      Removed     R-Square    R-Square     C(p)        AIC         RMSE      
------------------------------------------------------------------------------------------
   1    liver_test     addition       0.455       0.444    62.5120    771.8753    296.2992    
   2     alc_heavy     addition       0.567       0.550    41.3680    761.4394    266.6484    
   3    enzyme_test    addition       0.659       0.639    24.3380    750.5089    238.9145    
   4      pindex       addition       0.750       0.730     7.5370    735.7146    206.5835    
   5        bcs        addition       0.781       0.758     3.1920    730.6204    195.4544    
------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="stepwise-aic-forward-regression" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-aic-forward-regression"><strong>Stepwise AIC Forward Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by entering predictors based on Akaike Information Criteria, in a stepwise manner until there is no variable left to enter any more. The model should include all the candidate predictor variables. If details is set to <code>TRUE</code>, each step is displayed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_forward_aic</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                             Selection Summary                               
----------------------------------------------------------------------------
Variable         AIC        Sum Sq           RSS         R-Sq      Adj. R-Sq 
----------------------------------------------------------------------------
liver_test     771.875    3804272.477    4565248.060    0.45454      0.44405 
alc_heavy      761.439    4743349.776    3626170.761    0.56674      0.54975 
enzyme_test    750.509    5515514.136    2854006.401    0.65900      0.63854 
pindex         735.715    6278360.060    2091160.477    0.75015      0.72975 
bcs            730.620    6535804.090    1833716.447    0.78091      0.75808 
----------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_forward_aic</span>(model)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_forward_aic</span>(model, <span class="at">details =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Forward Selection Method 
------------------------

Candidate Terms: 

1 . bcs 
2 . pindex 
3 . enzyme_test 
4 . liver_test 
5 . age 
6 . gender 
7 . alc_mod 
8 . alc_heavy 

 Step 0: AIC = 802.606 
 y ~ 1 

--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
liver_test      1    771.875    3804272.477    4565248.060    0.455        0.444 
enzyme_test     1    782.629    2798309.881    5571210.656    0.334        0.322 
pindex          1    794.100    1479766.754    6889753.784    0.177        0.161 
alc_heavy       1    794.301    1454057.255    6915463.282    0.174        0.158 
bcs             1    797.697    1005151.658    7364368.879    0.120        0.103 
alc_mod         1    802.828     271062.330    8098458.207    0.032        0.014 
gender          1    802.956     251808.570    8117711.967    0.030        0.011 
age             1    803.834     118862.559    8250657.978    0.014       -0.005 
--------------------------------------------------------------------------------


- liver_test 


 Step 1 : AIC = 771.8753 
 y ~ liver_test 

-------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq          RSS        R-Sq     Adj. R-Sq 
-------------------------------------------------------------------------------
alc_heavy       1    761.439    939077.300    3626170.761    0.567        0.550 
enzyme_test     1    762.077    896004.331    3669243.729    0.562        0.544 
pindex          1    770.387    285591.786    4279656.274    0.489        0.469 
alc_mod         1    771.141    225396.238    4339851.822    0.481        0.461 
gender          1    773.802      6162.222    4559085.838    0.455        0.434 
age             1    773.831      3726.297    4561521.763    0.455        0.434 
bcs             1    773.867       685.256    4564562.805    0.455        0.433 
-------------------------------------------------------------------------------

- alc_heavy 


 Step 2 : AIC = 761.4394 
 y ~ liver_test + alc_heavy 

-------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq          RSS        R-Sq     Adj. R-Sq 
-------------------------------------------------------------------------------
enzyme_test     1    750.509    772164.360    2854006.401    0.659        0.639 
pindex          1    756.125    459358.635    3166812.126    0.622        0.599 
bcs             1    763.063     25195.587    3600975.173    0.570        0.544 
age             1    763.110     22048.109    3604122.652    0.569        0.544 
alc_mod         1    763.428       784.551    3625386.210    0.567        0.541 
gender          1    763.433       443.343    3625727.417    0.567        0.541 
-------------------------------------------------------------------------------

- enzyme_test 


 Step 3 : AIC = 750.5089 
 y ~ liver_test + alc_heavy + enzyme_test 

-----------------------------------------------------------------------------
Variable     DF      AIC        Sum Sq          RSS        R-Sq     Adj. R-Sq 
-----------------------------------------------------------------------------
pindex        1    735.715    762845.924    2091160.477    0.750        0.730 
bcs           1    750.782     89836.308    2764170.093    0.670        0.643 
alc_mod       1    752.403      5607.570    2848398.831    0.660        0.632 
age           1    752.416      4896.081    2849110.320    0.660        0.632 
gender        1    752.509         5.958    2854000.443    0.659        0.631 
-----------------------------------------------------------------------------

- pindex 


 Step 4 : AIC = 735.7146 
 y ~ liver_test + alc_heavy + enzyme_test + pindex 

-----------------------------------------------------------------------------
Variable     DF      AIC        Sum Sq          RSS        R-Sq     Adj. R-Sq 
-----------------------------------------------------------------------------
bcs           1    730.620    257444.030    1833716.447    0.781        0.758 
age           1    737.680      1325.880    2089834.596    0.750        0.724 
gender        1    737.712        90.186    2091070.290    0.750        0.724 
alc_mod       1    737.713        60.620    2091099.857    0.750        0.724 
-----------------------------------------------------------------------------

- bcs 


 Step 5 : AIC = 730.6204 
 y ~ liver_test + alc_heavy + enzyme_test + pindex + bcs 

---------------------------------------------------------------------------
Variable     DF      AIC       Sum Sq         RSS        R-Sq     Adj. R-Sq 
---------------------------------------------------------------------------
age           1    732.494    4280.830    1829435.617    0.781        0.754 
gender        1    732.551    2360.288    1831356.159    0.781        0.753 
alc_mod       1    732.614     216.992    1833499.455    0.781        0.753 
---------------------------------------------------------------------------


No more variables to be added.

Variables Entered: 

- liver_test 
- alc_heavy 
- enzyme_test 
- pindex 
- bcs 


Final Model Output 
------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                             Selection Summary                               
----------------------------------------------------------------------------
Variable         AIC        Sum Sq           RSS         R-Sq      Adj. R-Sq 
----------------------------------------------------------------------------
liver_test     771.875    3804272.477    4565248.060    0.45454      0.44405 
alc_heavy      761.439    4743349.776    3626170.761    0.56674      0.54975 
enzyme_test    750.509    5515514.136    2854006.401    0.65900      0.63854 
pindex         735.715    6278360.060    2091160.477    0.75015      0.72975 
bcs            730.620    6535804.090    1833716.447    0.78091      0.75808 
----------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="stepwise-aic-backward-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-aic-backward-regression-1"><strong>Stepwise AIC Backward Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by removing predictors based on Akaike Information Criteria, in a stepwise manner until there is no variable left to remove any more. The model should include all the candidate predictor variables. If details is set to <code>TRUE</code>, each step is displayed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_backward_aic</span>(model)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                        Backward Elimination Summary                         
---------------------------------------------------------------------------
Variable        AIC          RSS          Sum Sq        R-Sq      Adj. R-Sq 
---------------------------------------------------------------------------
Full Model    736.390    1825905.713    6543614.824    0.78184      0.74305 
alc_mod       734.407    1826477.828    6543042.709    0.78177      0.74856 
gender        732.494    1829435.617    6540084.920    0.78142      0.75351 
age           730.620    1833716.447    6535804.090    0.78091      0.75808 
---------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_backward_aic</span>(model, <span class="at">details =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Backward Elimination Method 
---------------------------

Candidate Terms: 

1 . bcs 
2 . pindex 
3 . enzyme_test 
4 . liver_test 
5 . age 
6 . gender 
7 . alc_mod 
8 . alc_heavy 

 Step 0: AIC = 736.3899 
 y ~ bcs + pindex + enzyme_test + liver_test + age + gender + alc_mod + alc_heavy 

--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
alc_mod        1     734.407        572.115    1826477.828    0.782        0.749 
gender         1     734.478       2990.338    1828896.051    0.781        0.748 
age            1     734.544       5231.108    1831136.821    0.781        0.748 
liver_test     1     735.878      51016.156    1876921.869    0.776        0.742 
bcs            1     741.677     263780.393    2089686.106    0.750        0.712 
alc_heavy      1     749.210     576636.222    2402541.935    0.713        0.669 
pindex         1     756.624     930187.311    2756093.024    0.671        0.621 
enzyme_test    1     763.557    1307756.930    3133662.644    0.626        0.569 
--------------------------------------------------------------------------------


Variables Removed: 

- alc_mod 


  Step 1 : AIC = 734.4068 
 y ~ bcs + pindex + enzyme_test + liver_test + age + gender + alc_heavy 

--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
gender         1     732.494       2957.789    1829435.617    0.781        0.754 
age            1     732.551       4878.331    1831356.159    0.781        0.753 
liver_test     1     733.921      51951.343    1878429.171    0.776        0.747 
bcs            1     739.677     263219.094    2089696.922    0.750        0.718 
alc_heavy      1     750.486     726328.685    2552806.513    0.695        0.656 
pindex         1     754.759     936543.762    2763021.590    0.670        0.628 
enzyme_test    1     761.595    1309433.007    3135910.834    0.625        0.577 
--------------------------------------------------------------------------------

- gender 


  Step 2 : AIC = 732.4942 
 y ~ bcs + pindex + enzyme_test + liver_test + age + alc_heavy 

--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
age            1     730.620       4280.830    1833716.447    0.781        0.758 
liver_test     1     732.339      63596.190    1893031.807    0.774        0.750 
bcs            1     737.680     260398.979    2089834.596    0.750        0.724 
alc_heavy      1     748.486     723371.473    2552807.090    0.695        0.663 
pindex         1     752.777     934511.071    2763946.688    0.670        0.635 
enzyme_test    1     759.596    1306482.666    3135918.283    0.625        0.586 
--------------------------------------------------------------------------------

- age 


  Step 3 : AIC = 730.6204 
 y ~ bcs + pindex + enzyme_test + liver_test + alc_heavy 

--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
liver_test     1     730.924      79919.825    1913636.272    0.771        0.753 
bcs            1     735.715     257444.030    2091160.477    0.750        0.730 
alc_heavy      1     747.181     752122.827    2585839.274    0.691        0.666 
pindex         1     750.782     930453.646    2764170.093    0.670        0.643 
enzyme_test    1     757.971    1324076.125    3157792.572    0.623        0.592 
--------------------------------------------------------------------------------


No more variables to be removed.

Variables Removed: 

- alc_mod 
- gender 
- age 


Final Model Output 
------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
------------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                        Backward Elimination Summary                         
---------------------------------------------------------------------------
Variable        AIC          RSS          Sum Sq        R-Sq      Adj. R-Sq 
---------------------------------------------------------------------------
Full Model    736.390    1825905.713    6543614.824    0.78184      0.74305 
alc_mod       734.407    1826477.828    6543042.709    0.78177      0.74856 
gender        732.494    1829435.617    6540084.920    0.78142      0.75351 
age           730.620    1833716.447    6535804.090    0.78091      0.75808 
---------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="stepwise-aic-regression" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-aic-regression"><strong>Stepwise AIC Regression</strong></h2>
<p>Build regression model from a set of candidate predictor variables by entering and removing predictors based on Akaike Information Criteria, in a stepwise manner until there is no variable left to enter or remove any more. The model should include all the candidate predictor variables. If details is set to <code>TRUE</code>, each step is displayed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stepwise aic regression</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> surgical)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_aic</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                     Stepwise Summary                                     
----------------------------------------------------------------------------------------
Variable        Method       AIC          RSS          Sum Sq        R-Sq      Adj. R-Sq 
----------------------------------------------------------------------------------------
liver_test     addition    771.875    4565248.060    3804272.477    0.45454      0.44405 
alc_heavy      addition    761.439    3626170.761    4743349.776    0.56674      0.54975 
enzyme_test    addition    750.509    2854006.401    5515514.136    0.65900      0.63854 
pindex         addition    735.715    2091160.477    6278360.060    0.75015      0.72975 
bcs            addition    730.620    1833716.447    6535804.090    0.78091      0.75808 
----------------------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#detailed outpu</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_aic</span>(model, <span class="at">details =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method 
-------------------------

Candidate Terms: 

1 . bcs 
2 . pindex 
3 . enzyme_test 
4 . liver_test 
5 . age 
6 . gender 
7 . alc_mod 
8 . alc_heavy 

 Step 0: AIC = 802.606 
 y ~ 1 


Variables Entered/Removed: 

                               Enter New Variables                              
--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
liver_test      1    771.875    3804272.477    4565248.060    0.455        0.444 
enzyme_test     1    782.629    2798309.881    5571210.656    0.334        0.322 
pindex          1    794.100    1479766.754    6889753.784    0.177        0.161 
alc_heavy       1    794.301    1454057.255    6915463.282    0.174        0.158 
bcs             1    797.697    1005151.658    7364368.879    0.120        0.103 
alc_mod         1    802.828     271062.330    8098458.207    0.032        0.014 
gender          1    802.956     251808.570    8117711.967    0.030        0.011 
age             1    803.834     118862.559    8250657.978    0.014       -0.005 
--------------------------------------------------------------------------------

- liver_test added 


 Step 1 : AIC = 771.8753 
 y ~ liver_test 

                               Enter New Variables                              
--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
alc_heavy       1    761.439    4743349.776    3626170.761    0.567        0.550 
enzyme_test     1    762.077    4700276.808    3669243.729    0.562        0.544 
pindex          1    770.387    4089864.263    4279656.274    0.489        0.469 
alc_mod         1    771.141    4029668.715    4339851.822    0.481        0.461 
gender          1    773.802    3810434.699    4559085.838    0.455        0.434 
age             1    773.831    3807998.774    4561521.763    0.455        0.434 
bcs             1    773.867    3804957.732    4564562.805    0.455        0.433 
--------------------------------------------------------------------------------

- alc_heavy added 


 Step 2 : AIC = 761.4394 
 y ~ liver_test + alc_heavy 

                           Remove Existing Variables                           
-------------------------------------------------------------------------------
Variable      DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
-------------------------------------------------------------------------------
alc_heavy      1    771.875    3804272.477    4565248.060    0.455        0.444 
liver_test     1    794.301    1454057.255    6915463.282    0.174        0.158 
-------------------------------------------------------------------------------

                               Enter New Variables                              
--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
enzyme_test     1    750.509    5515514.136    2854006.401    0.659        0.639 
pindex          1    756.125    5202708.411    3166812.126    0.622        0.599 
bcs             1    763.063    4768545.364    3600975.173    0.570        0.544 
age             1    763.110    4765397.885    3604122.652    0.569        0.544 
alc_mod         1    763.428    4744134.327    3625386.210    0.567        0.541 
gender          1    763.433    4743793.120    3625727.417    0.567        0.541 
--------------------------------------------------------------------------------

- enzyme_test added 


 Step 3 : AIC = 750.5089 
 y ~ liver_test + alc_heavy + enzyme_test 

                           Remove Existing Variables                            
--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
enzyme_test     1    761.439    4743349.776    3626170.761    0.567        0.550 
alc_heavy       1    762.077    4700276.808    3669243.729    0.562        0.544 
liver_test      1    773.555    3831289.024    4538231.513    0.458        0.437 
--------------------------------------------------------------------------------

                              Enter New Variables                             
------------------------------------------------------------------------------
Variable     DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
------------------------------------------------------------------------------
pindex        1    735.715    6278360.060    2091160.477    0.750        0.730 
bcs           1    750.782    5605350.444    2764170.093    0.670        0.643 
alc_mod       1    752.403    5521121.706    2848398.831    0.660        0.632 
age           1    752.416    5520410.217    2849110.320    0.660        0.632 
gender        1    752.509    5515520.094    2854000.443    0.659        0.631 
------------------------------------------------------------------------------

- pindex added 


 Step 4 : AIC = 735.7146 
 y ~ liver_test + alc_heavy + enzyme_test + pindex 

                           Remove Existing Variables                            
--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
liver_test      1    748.167    5636649.760    2732870.777    0.673        0.654 
pindex          1    750.509    5515514.136    2854006.401    0.659        0.639 
alc_heavy       1    755.099    5262294.325    3107226.212    0.629        0.606 
enzyme_test     1    756.125    5202708.411    3166812.126    0.622        0.599 
--------------------------------------------------------------------------------

                              Enter New Variables                             
------------------------------------------------------------------------------
Variable     DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
------------------------------------------------------------------------------
bcs           1    730.620    6535804.090    1833716.447    0.781        0.758 
age           1    737.680    6279685.941    2089834.596    0.750        0.724 
gender        1    737.712    6278450.247    2091070.290    0.750        0.724 
alc_mod       1    737.713    6278420.680    2091099.857    0.750        0.724 
------------------------------------------------------------------------------

- bcs added 


 Step 5 : AIC = 730.6204 
 y ~ liver_test + alc_heavy + enzyme_test + pindex + bcs 

                           Remove Existing Variables                            
--------------------------------------------------------------------------------
Variable       DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
--------------------------------------------------------------------------------
liver_test      1    730.924    6455884.265    1913636.272    0.771        0.753 
bcs             1    735.715    6278360.060    2091160.477    0.750        0.730 
alc_heavy       1    747.181    5783681.263    2585839.274    0.691        0.666 
pindex          1    750.782    5605350.444    2764170.093    0.670        0.643 
enzyme_test     1    757.971    5211727.965    3157792.572    0.623        0.592 
--------------------------------------------------------------------------------

                              Enter New Variables                             
------------------------------------------------------------------------------
Variable     DF      AIC        Sum Sq           RSS        R-Sq     Adj. R-Sq 
------------------------------------------------------------------------------
age           1    732.494    6540084.920    1829435.617    0.781        0.754 
gender        1    732.551    6538164.378    1831356.159    0.781        0.753 
alc_mod       1    732.614    6536021.082    1833499.455    0.781        0.753 
------------------------------------------------------------------------------


No more variables to be added or removed.

Final Model Output 
------------------

                          Model Summary                           
-----------------------------------------------------------------
R                       0.884       RMSE                 195.454 
R-Squared               0.781       Coef. Var             27.839 
Adj. R-Squared          0.758       MSE                38202.426 
Pred R-Squared          0.700       MAE                  137.656 
-----------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                 ANOVA                                  
-----------------------------------------------------------------------
                   Sum of                                              
                  Squares        DF    Mean Square      F         Sig. 
-----------------------------------------------------------------------
Regression    6535804.090         5    1307160.818    34.217    0.0000 
Residual      1833716.447        48      38202.426                     
Total         8369520.537        53                                    
-----------------------------------------------------------------------

                                      Parameter Estimates                                        
------------------------------------------------------------------------------------------------
      model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
------------------------------------------------------------------------------------------------
(Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
 liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
  alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
     pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
        bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
------------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                     Stepwise Summary                                     
----------------------------------------------------------------------------------------
Variable        Method       AIC          RSS          Sum Sq        R-Sq      Adj. R-Sq 
----------------------------------------------------------------------------------------
liver_test     addition    771.875    4565248.060    3804272.477    0.45454      0.44405 
alc_heavy      addition    761.439    3626170.761    4743349.776    0.56674      0.54975 
enzyme_test    addition    750.509    2854006.401    5515514.136    0.65900      0.63854 
pindex         addition    735.715    2091160.477    6278360.060    0.75015      0.72975 
bcs            addition    730.620    1833716.447    6535804.090    0.78091      0.75808 
----------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="residual-diagnostics" class="level1">
<h1>Residual Diagnostics</h1>
<p><strong>Residual QQ Plot</strong></p>
<p>Graph for detecting violation of normality assumption.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_qq</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="residual-normality-test" class="level2">
<h2 class="anchored" data-anchor-id="residual-normality-test"><strong>Residual Normality Test</strong></h2>
<p>Test for detecting violation of normality assumption.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_normality</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.9366         0.0600 
Kolmogorov-Smirnov        0.1152         0.7464 
Cramer-von Mises          2.8122         0.0000 
Anderson-Darling          0.5859         0.1188 
-----------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation between observed and expected results</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_correlation</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.970066</code></pre>
</div>
</div>
</section>
<section id="residual-vs-fitted-values-plot-1" class="level2">
<h2 class="anchored" data-anchor-id="residual-vs-fitted-values-plot-1"><strong>Residual vs Fitted Values Plot</strong></h2>
<p>It is a scatter plot of residuals on the y axis and fitted values on the x axis to detect non-linearity, unequal error variances, and outliers.</p>
<p><strong>Characteristics of a well behaved residual vs fitted plot:</strong></p>
<ul>
<li><p>The residuals spread randomly around the 0 line indicating that the relationship is linear.</p></li>
<li><p>The residuals form an approximate horizontal band around the 0 line indicating homogeneity of error variance.</p></li>
<li><p>No one residual is visibly away from the random pattern of the residuals indicating that there are no outliers.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="residual-histogram" class="level2">
<h2 class="anchored" data-anchor-id="residual-histogram"><strong>Residual Histogram</strong></h2>
<p>Histogram of residuals for detecting violation of normality assumption.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_hist</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="heteroscedasticity" class="level1">
<h1><strong>Heteroscedasticity</strong></h1>
</section>
<section id="introduction" class="level1">
<h1><strong>Introduction</strong></h1>
<p>One of the assumptions made about residuals/errors in OLS regression is that the errors have the same but unknown variance. This is known as constant variance or homoscedasticity. When this assumption is violated, the problem is known as heteroscedasticity.</p>
<section id="consequences-of-heteroscedasticity" class="level5">
<h5 class="anchored" data-anchor-id="consequences-of-heteroscedasticity"><strong>Consequences of Heteroscedasticity</strong></h5>
<ul>
<li><p>The OLS estimators and regression predictions based on them remains unbiased and consistent.</p></li>
<li><p>The OLS estimators are no longer the BLUE (Best Linear Unbiased Estimators) because they are no longer efficient, so the regression predictions will be inefficient too.</p></li>
<li><p>Because of the inconsistency of the covariance matrix of the estimated regression coefficients, the tests of hypotheses, (t-test, F-test) are no longer valid.</p></li>
</ul>
<p><strong>olsrr</strong> provides the following 4 tests for detecting heteroscedasticity:</p>
<ul>
<li><p>Bartlett Test</p></li>
<li><p>Breusch Pagan Test</p></li>
<li><p>Score Test</p></li>
<li><p>F Test</p></li>
</ul>
</section>
<section id="bartlett-test" class="level2">
<h2 class="anchored" data-anchor-id="bartlett-test"><strong>Bartlett Test</strong></h2>
<p>Bartlett’s test is used to test if variances across samples is equal. It is sensitive to departures from normality. The Levene test is an alternative test that is less sensitive to departures from normality.</p>
<p>You can perform the test using 2 continuous variables, one continuous and one grouping variable, a formula or a linear model.</p>
<section id="use-grouping-variable" class="level4">
<h4 class="anchored" data-anchor-id="use-grouping-variable"><strong>Use grouping variable</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_bartlett</span>(hsb, <span class="st">'read'</span>, <span class="at">group_var =</span> <span class="st">'female'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett's Test of Homogenity of Variances    
------------------------------------------------
Ho: Variances are equal across groups
Ha: Variances are unequal for atleast two groups

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    0.1866579 
 Prob &gt; Chi2   =    0.6657129 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using variables</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_bartlett</span>(hsb, <span class="st">'read'</span>, <span class="st">'write'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett's Test of Homogenity of Variances    
------------------------------------------------
Ho: Variances are equal across groups
Ha: Variances are unequal for atleast two groups

        Data          
 ---------------------
 Variables: read write 

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    1.222871 
 Prob &gt; Chi2   =    0.2687979 </code></pre>
</div>
</div>
</section>
</section>
<section id="breusch-pagan-test-1" class="level2">
<h2 class="anchored" data-anchor-id="breusch-pagan-test-1"><strong>Breusch Pagan Test</strong></h2>
<p>Breusch Pagan Test was introduced by Trevor Breusch and Adrian Pagan in 1979. It is used to test for heteroskedasticity in a linear regression model and assumes that the error terms are normally distributed. It tests whether the variance of the errors from a regression is dependent on the values of the independent variables. It is a χ2χ2 test.</p>
<p>You can perform the test using the fitted values of the model, the predictors in the model and a subset of the independent variables. It includes options to perform multiple tests and p value adjustments. The options for p value adjustments include Bonferroni, Sidak and Holm’s method.</p>
<section id="use-fitted-values-of-the-model" class="level4">
<h4 class="anchored" data-anchor-id="use-fitted-values-of-the-model"><strong>Use fitted values of the model</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> drat, <span class="at">data =</span> mtcars)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

             Data               
 -------------------------------
 Response : mpg 
 Variables: fitted values of mpg 

       Test Summary         
 ---------------------------
 DF            =    1 
 Chi2          =    1.429672 
 Prob &gt; Chi2   =    0.231818 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use independent variables of the model</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model, <span class="at">rhs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

        Test Summary         
 ----------------------------
 DF            =    4 
 Chi2          =    1.513808 
 Prob &gt; Chi2   =    0.8241927 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use independent variables of the model and perform multiple tests</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model, <span class="at">rhs =</span> <span class="cn">TRUE</span>, <span class="at">multiple =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

        Test Summary (Unadjusted p values)       
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    0.2663334 
  hp               0.9209878     1    0.3372157 
  wt               1.2529988     1    0.2629805 
  drat             1.1668486     1    0.2800497 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bonferroni p value adjustment</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model, <span class="at">rhs =</span> <span class="cn">TRUE</span>, <span class="at">multiple =</span> <span class="cn">TRUE</span>, <span class="at">p.adj =</span> <span class="st">'bonferroni'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

        Test Summary (Bonferroni p values)       
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    1.0000000 
  hp               0.9209878     1    1.0000000 
  wt               1.2529988     1    1.0000000 
  drat             1.1668486     1    1.0000000 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sidak p value Adjustment</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model, <span class="at">rhs =</span> <span class="cn">TRUE</span>, <span class="at">multiple =</span> <span class="cn">TRUE</span>, <span class="at">p.adj =</span> <span class="st">'sidak'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

          Test Summary (Sidak p values)          
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    0.7102690 
  hp               0.9209878     1    0.8070305 
  wt               1.2529988     1    0.7049362 
  drat             1.1668486     1    0.7313356 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Holms p value adjustment</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_breusch_pagan</span>(model, <span class="at">rhs =</span> <span class="cn">TRUE</span>, <span class="at">multiple =</span> <span class="cn">TRUE</span>, <span class="at">p.adj =</span> <span class="st">'holm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Breusch Pagan Test for Heteroskedasticity
 -----------------------------------------
 Ho: the variance is constant            
 Ha: the variance is not constant        

           Data            
 --------------------------
 Response : mpg 
 Variables: disp hp wt drat 

          Test Summary (Holm's p values)         
 ----------------------------------------------
  Variable           chi2       df        p     
 ----------------------------------------------
  disp             1.2355345     1    0.7990002 
  hp               0.9209878     1    0.3372157 
  wt               1.2529988     1    1.0000000 
  drat             1.1668486     1    0.5600994 
 ----------------------------------------------
  simultaneous     1.5138083     4    0.8241927 
 ----------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="score-test" class="level2">
<h2 class="anchored" data-anchor-id="score-test"><strong>Score Test</strong></h2>
<p>Test for heteroskedasticity under the assumption that the errors are independent and identically distributed (i.i.d.). You can perform the test using the fitted values of the model, the predictors in the model and a subset of the independent variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_score</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: fitted values of mpg 

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    0.5163959 
 Prob &gt; Chi2   =    0.4723832 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use independient variables of the model</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_score</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: fitted values of mpg 

        Test Summary         
 ----------------------------
 DF            =    1 
 Chi2          =    0.5163959 
 Prob &gt; Chi2   =    0.4723832 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Specify variables</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_score</span>(model, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">'disp'</span>, <span class="st">'hp'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Score Test for Heteroskedasticity
 ---------------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp hp 

        Test Summary         
 ----------------------------
 DF            =    2 
 Chi2          =    0.9983196 
 Prob &gt; Chi2   =    0.6070405 </code></pre>
</div>
</div>
</section>
<section id="f-test" class="level2">
<h2 class="anchored" data-anchor-id="f-test"><strong>F Test</strong></h2>
<p>F Test for heteroskedasticity under the assumption that the errors are independent and identically distributed (i.i.d.). You can perform the test using the fitted values of the model, the predictors in the model and a subset of the independent variables.</p>
<section id="use-fitted-values-of-the-model-1" class="level4">
<h4 class="anchored" data-anchor-id="use-fitted-values-of-the-model-1"><strong>Use fitted values of the model</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_f</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 F Test for Heteroskedasticity
 -----------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: fitted values of mpg 

      Test Summary        
 -------------------------
 Num DF     =    1 
 Den DF     =    30 
 F          =    0.4920617 
 Prob &gt; F   =    0.4884154 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use independient variables of the model</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_f</span>(model, <span class="at">rhs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 F Test for Heteroskedasticity
 -----------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp hp wt qsec 

      Test Summary        
 -------------------------
 Num DF     =    4 
 Den DF     =    27 
 F          =    0.4594694 
 Prob &gt; F   =    0.7647271 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Specify the variables</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_f</span>(model, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">'disp'</span>, <span class="st">'hp'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 F Test for Heteroskedasticity
 -----------------------------
 Ho: Variance is homogenous
 Ha: Variance is not homogenous

 Variables: disp hp 

      Test Summary        
 -------------------------
 Num DF     =    2 
 Den DF     =    29 
 F          =    0.4669306 
 Prob &gt; F   =    0.631555 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="measures-of-influence" class="level1">
<h1><strong>Measures of Influence</strong></h1>
<section id="introduction-1" class="level2">
<h2 class="anchored" data-anchor-id="introduction-1"><strong>Introduction</strong></h2>
<p>It is possible for a single observation to have a great influence on the results of a regression analysis. It is therefore important to detect influential observations and to take them into consideration when interpreting the results.</p>
<p><strong>olsrr</strong> offers the following tools to detect influential observations:</p>
<ul>
<li><p>Cook’s D Bar Plot</p></li>
<li><p>Cook’s D Chart</p></li>
<li><p>DFBETAs Panel</p></li>
<li><p>DFFITs Plot</p></li>
<li><p>Studentized Residual Plot</p></li>
<li><p>Standardized Residual Chart</p></li>
<li><p>Studentized Residuals vs Leverage Plot</p></li>
<li><p>Deleted Studentized Residual vs Fitted Values Plot</p></li>
<li><p>Hadi Plot</p></li>
<li><p>Potential Residual Plot</p></li>
</ul>
</section>
<section id="cooks-d-bar-plot" class="level2">
<h2 class="anchored" data-anchor-id="cooks-d-bar-plot"><strong>Cook’s D Bar Plot</strong></h2>
<p>Bar Plot of Cook’s distance to detect observations that strongly influence fitted values of the model. Cook’s distance was introduced by American statistician R Dennis Cook in 1977. It is used to identify influential data points. It depends on both the residual and leverage i.e it takes it account both the <strong>x</strong> value and <strong>y</strong> value of the observation.</p>
<p><strong>Steps to compute Cook’s distance:</strong></p>
<ul>
<li><p>delete observations one at a time.</p></li>
<li><p>refit the regression model on remaining (n−1)(n−1) observations</p></li>
<li><p>examine how much all of the fitted values change when the ith observation is deleted.</p></li>
</ul>
<p>A data point having a large cook’s d indicates that the data point strongly influences the fitted values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_cooksd_bar</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cooks-d-chart" class="level2">
<h2 class="anchored" data-anchor-id="cooks-d-chart"><strong>Cook’s D Chart</strong></h2>
<p>Chart of Cook’s distance to detect observations that strongly influence fitted values of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_cooksd_chart</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="dfbetas-panel-1" class="level2">
<h2 class="anchored" data-anchor-id="dfbetas-panel-1"><strong>DFBETAs Panel</strong></h2>
<p>DFBETA measures the difference in each parameter estimate with and without the influential point. There is a DFBETA for each data point i.e if there are n observations and k variables, there will be n∗kn∗k DFBETAs. In general, large values of DFBETAS indicate observations that are influential in estimating a given parameter. Belsley, Kuh, and Welsch recommend 2 as a general cutoff value to indicate influential observations and 2n√2n as a size-adjusted cutoff.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_dfbetas</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</section>
<section id="dffits-plot" class="level2">
<h2 class="anchored" data-anchor-id="dffits-plot"><strong>DFFITS Plot</strong></h2>
<p>Proposed by Welsch and Kuh (1977). It is the scaled difference between the ithith fitted value obtained from the full data and the ithith fitted value obtained by deleting the ithith observation. DFFIT - difference in fits, is used to identify influential data points. It quantifies the number of standard deviations that the fitted value changes when the ith data point is omitted.</p>
<p><strong>Steps to compute DFFITs:</strong></p>
<ul>
<li><p>delete observations one at a time.</p></li>
<li><p>refit the regression model on remaining observations</p></li>
<li><p>examine how much all of the fitted values change when the ith observation is deleted.</p></li>
</ul>
<p>An observation is deemed influential if the absolute value of its DFFITS value is greater than:</p>
<p>where n is the number of observations and p is the number of predictors including intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_dffits</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="studentized-residual-plot" class="level2">
<h2 class="anchored" data-anchor-id="studentized-residual-plot"><strong>Studentized Residual Plot</strong></h2>
<p>Plot for detecting outliers. Studentized deleted residuals (or externally studentized residuals) is the deleted residual divided by its estimated standard deviation. Studentized residuals are going to be more effective for detecting outlying Y observations than standardized residuals. If an observation has an externally studentized residual that is larger than 3 (in absolute value) we can call it an outlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_stud</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="standardized-residual-chart" class="level2">
<h2 class="anchored" data-anchor-id="standardized-residual-chart"><strong>Standardized Residual Chart</strong></h2>
<p>Chart for detecting outliers. Standardized residual (internally studentized) is the residual divided by estimated standard deviation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_stand</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="studentized-residuals-vs-leverage-plot" class="level2">
<h2 class="anchored" data-anchor-id="studentized-residuals-vs-leverage-plot"><strong>Studentized Residuals vs Leverage Plot</strong></h2>
<p>Graph for detecting influential observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(read <span class="sc">~</span> write <span class="sc">+</span> math <span class="sc">+</span> science, <span class="at">data =</span> hsb)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_lev</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="deleted-studentized-residual-vs-fitted-values-plot" class="level2">
<h2 class="anchored" data-anchor-id="deleted-studentized-residual-vs-fitted-values-plot"><strong>Deleted Studentized Residual vs Fitted Values Plot</strong></h2>
<p>Graph for detecting outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_stud_fit</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="hadi-plot" class="level2">
<h2 class="anchored" data-anchor-id="hadi-plot"><strong>Hadi Plot</strong></h2>
<p>Hadi's measure of influence based on the fact that influential observations can be present in either the response variable or in the predictors or both. The plot is used to detect influential observations based on Hadi's measure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_hadi</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="potential-residual-plot" class="level2">
<h2 class="anchored" data-anchor-id="potential-residual-plot"><strong>Potential Residual Plot</strong></h2>
<p>Plot to aid in classifying unusual observations as high-leverage points, outliers, or a combination of both.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_pot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="collinearity-diagnostics-model-fit-variable-contribution" class="level1">
<h1><strong>Collinearity Diagnostics, Model Fit &amp; Variable Contribution</strong></h1>
<section id="collinearity-diagnostics-1" class="level3">
<h3 class="anchored" data-anchor-id="collinearity-diagnostics-1"><strong>Collinearity Diagnostics</strong></h3>
<p>Collinearity implies two variables are near perfect linear combinations of one another. Multicollinearity involves more than two variables. In the presence of multicollinearity, regression estimates are unstable and have high standard errors.</p>
</section>
<section id="vif" class="level3">
<h3 class="anchored" data-anchor-id="vif"><strong>VIF</strong></h3>
<p>Variance inflation factors measure the inflation in the variances of the parameter estimates due to collinearities that exist among the predictors. It is a measure of how much the variance of the estimated regression coefficient βkβk is "inflated" by the existence of correlation among the predictor variables in the model. A VIF of 1 means that there is no correlation among the kth predictor and the remaining predictor variables, and hence the variance of βkβk is not inflated at all. The general rule of thumb is that VIFs exceeding 4 warrant further investigation, while VIFs exceeding 10 are signs of serious multicollinearity requiring correction.</p>
<p>Steps to calculate VIF:</p>
<ul>
<li>Regress the kthkth pre</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Variables Tolerance      VIF
1      disp 0.1252279 7.985439
2        hp 0.1935450 5.166758
3        wt 0.1445726 6.916942
4      qsec 0.3191708 3.133119</code></pre>
</div>
</div>
</section>
<section id="tolerance" class="level3">
<h3 class="anchored" data-anchor-id="tolerance"><strong>Tolerance</strong></h3>
<p>Percent of variance in the predictor that cannot be accounted for by other predictors.</p>
<p>Steps to calculate tolerance:</p>
<ul>
<li><p>Regress the <span class="math inline">\(k^{th}\)</span> predictor on rest of the predictors in the model.</p></li>
<li><p>Compute the <span class="math inline">\(R2kRk2\)</span></p></li>
</ul>
<p><span class="math inline">\(Tolerance=1−R2kTolerance=1−Rk2\)</span></p>
</section>
<section id="condition-index" class="level3">
<h3 class="anchored" data-anchor-id="condition-index"><strong>Condition Index</strong></h3>
<p>Most multivariate statistical approaches involve decomposing a correlation matrix into linear combinations of variables. The linear combinations are chosen so that the first combination has the largest possible variance (subject to some restrictions we won't discuss), the second combination has the next largest variance, subject to being uncorrelated with the first, the third has the largest possible variance, subject to being uncorrelated with the first and second, and so forth. The variance of each of these linear combinations is called an eigenvalue. Collinearity is spotted by finding 2 or more variables that have large proportions of variance (.50 or more) that correspond to large condition indices. A rule of thumb is to label as large those condition indices in the range of 30 or larger.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_eigen_cindex</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Eigenvalue Condition Index   intercept        disp          hp           wt
1 4.721487187        1.000000 0.000123237 0.001132468 0.001413094 0.0005253393
2 0.216562203        4.669260 0.002617424 0.036811051 0.027751289 0.0002096014
3 0.050416837        9.677242 0.001656551 0.120881424 0.392366164 0.0377028008
4 0.010104757       21.616057 0.025805998 0.777260487 0.059594623 0.7017528428
5 0.001429017       57.480524 0.969796790 0.063914571 0.518874831 0.2598094157
          qsec
1 0.0001277169
2 0.0046789491
3 0.0001952599
4 0.0024577686
5 0.9925403056</code></pre>
</div>
</div>
</section>
<section id="collinearity-diagnostics-2" class="level3">
<h3 class="anchored" data-anchor-id="collinearity-diagnostics-2"><strong>Collinearity Diagnostics</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_coll_diag</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tolerance and Variance Inflation Factor
---------------------------------------
  Variables Tolerance      VIF
1      disp 0.1252279 7.985439
2        hp 0.1935450 5.166758
3        wt 0.1445726 6.916942
4      qsec 0.3191708 3.133119


Eigenvalue and Condition Index
------------------------------
   Eigenvalue Condition Index   intercept        disp          hp           wt
1 4.721487187        1.000000 0.000123237 0.001132468 0.001413094 0.0005253393
2 0.216562203        4.669260 0.002617424 0.036811051 0.027751289 0.0002096014
3 0.050416837        9.677242 0.001656551 0.120881424 0.392366164 0.0377028008
4 0.010104757       21.616057 0.025805998 0.777260487 0.059594623 0.7017528428
5 0.001429017       57.480524 0.969796790 0.063914571 0.518874831 0.2598094157
          qsec
1 0.0001277169
2 0.0046789491
3 0.0001952599
4 0.0024577686
5 0.9925403056</code></pre>
</div>
</div>
</section>
<section id="model-fit-assessment" class="level2">
<h2 class="anchored" data-anchor-id="model-fit-assessment"><strong>Model Fit Assessment</strong></h2>
<section id="residual-fit-spread-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="residual-fit-spread-plot-1"><strong>Residual Fit Spread Plot</strong></h3>
<p>Plot to detect non-linearity, influential observations and outliers. Consists of side-by-side quantile plots of the centered fit and the residuals. It shows how much variation in the data is explained by the fit and how much remains in the residuals. For inappropriate models, the spread of the residuals in such a plot is often greater than the spread of the centered fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit_spread</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="part-partial-correlations" class="level3">
<h3 class="anchored" data-anchor-id="part-partial-correlations"><strong>Part &amp; Partial Correlations</strong></h3>
<section id="correlations" class="level4">
<h4 class="anchored" data-anchor-id="correlations"><strong>Correlations</strong></h4>
<p>Relative importance of independent variables in determining <strong>Y</strong>. How much each variable uniquely contributes to <span class="math inline">\(R^2\)</span> over and above that which can be accounted for by the other predictors.</p>
<section id="zero-order" class="level5">
<h5 class="anchored" data-anchor-id="zero-order"><strong>Zero Order</strong></h5>
<p>Pearson correlation coefficient between the dependent variable and the independent variables.</p>
</section>
<section id="part" class="level5">
<h5 class="anchored" data-anchor-id="part"><strong>Part</strong></h5>
<p>Unique contribution of independent variables. How much $R^2$ will decrease if that variable is removed from the model?</p>
</section>
<section id="partial" class="level5">
<h5 class="anchored" data-anchor-id="partial"><strong>Partial</strong></h5>
<p>How much of the variance in <strong>Y</strong>, which is not estimated by the other independent variables in the model, is estimated by the specific variable?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_correlations</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Correlations                 
-------------------------------------------
Variable    Zero Order    Partial     Part  
-------------------------------------------
disp            -0.848      0.048     0.019 
hp              -0.776     -0.224    -0.093 
wt              -0.868     -0.574    -0.285 
qsec             0.419      0.219     0.091 
-------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="observed-vs-predicted-plot" class="level3">
<h3 class="anchored" data-anchor-id="observed-vs-predicted-plot"><strong>Observed vs Predicted Plot</strong></h3>
<p>Plot of observed vs fitted values to assess the fit of the model. Ideally, all your points should be close to a regressed diagonal line. Draw such a diagonal line within your graph and check out where the points lie. If your model had a high R Square, all the points would be close to this diagonal line. The lower the R Square, the weaker the Goodness of fit of your model, the more foggy or dispersed your points are from this diagonal line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_obs_fit</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="lack-of-fit-f-test" class="level3">
<h3 class="anchored" data-anchor-id="lack-of-fit-f-test"><strong>Lack of Fit F Test</strong></h3>
<p>Assess how much of the error in prediction is due to lack of model fit. The residual sum of squares resulting from a regression can be decomposed into 2 components:</p>
<ul>
<li><p>Due to lack of fit</p></li>
<li><p>Due to random variation</p></li>
</ul>
<p>If most of the error is due to lack of fit and not just random error, the model should be discarded and a new model must be built. The lack of fit F test works only with simple linear regression. Moreover, it is important that the data contains repeat observations i.e.&nbsp;replicates for at least one of the values of the predictor x. This test generally only applies to datasets with plenty of replicates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> mtcars)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_pure_error_anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lack of Fit F Test 
-----------------
Response :   mpg 
Predictor:   disp 

                      Analysis of Variance Table                       
----------------------------------------------------------------------
                DF     Sum Sq     Mean Sq     F Value        Pr(&gt;F)    
----------------------------------------------------------------------
disp             1    808.8885    808.8885    314.0095    1.934413e-17 
Residual        30    317.1587    10.57196                             
 Lack of fit    25    304.2787    12.17115    4.724824      0.04563623 
 Pure Error      5       12.88       2.576                             
----------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="diagnostics-panel" class="level3">
<h3 class="anchored" data-anchor-id="diagnostics-panel"><strong>Diagnostics Panel</strong></h3>
<p>Panel of plots for regression diagnostics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_diagnostics</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-41-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="variable-contributions" class="level2">
<h2 class="anchored" data-anchor-id="variable-contributions"><strong>Variable Contributions</strong></h2>
<section id="residual-vs-regressor-plots" class="level3">
<h3 class="anchored" data-anchor-id="residual-vs-regressor-plots"><strong>Residual vs Regressor Plots</strong></h3>
<p>Graph to determine whether we should add a new predictor to the model already containing other predictors. The residuals from the model is regressed on the new predictor and if the plot shows non random pattern, you should consider adding the new predictor to the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_regressor</span>(model, <span class="st">'drat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="added-variable-plot" class="level3">
<h3 class="anchored" data-anchor-id="added-variable-plot"><strong>Added Variable Plot</strong></h3>
<p>Added variable plot provides information about the marginal importance of a predictor variable XkXk, given the other predictor variables already in the model. It shows the marginal importance of the variable in reducing the residual variability.</p>
<p>The added variable plot was introduced by Mosteller and Tukey (1977). It enables us to visualize the regression coefficient of a new variable being considered to be included in a model. The plot can be constructed for each predictor variable.</p>
<p>Let us assume we want to test the effect of adding/removing variable <em>X</em> from a model. Let the response variable of the model be <em>Y</em></p>
<p>Steps to construct an added variable plot:</p>
<ul>
<li><p>Regress <em>Y</em> on all variables other than <em>X</em> and store the residuals (<em>Y</em> residuals).</p></li>
<li><p>Regress <em>X</em> on all the other variables included in the model (<em>X</em> residuals).</p></li>
<li><p>Construct a scatter plot of <em>Y</em> residuals and <em>X</em> residuals.</p></li>
</ul>
<p>What do the <em>Y</em> and <em>X</em> residuals represent? The <em>Y</em> residuals represent the part of <strong>Y</strong> not explained by all the variables other than X. The <em>X</em> residuals represent the part of <strong>X</strong> not explained by other variables. The slope of the line fitted to the points in the added variable plot is equal to the regression coefficient when <strong>Y</strong> is regressed on all variables including <strong>X</strong>.</p>
<p>A strong linear relationship in the added variable plot indicates the increased importance of the contribution of <strong>X</strong> to the model already containing the other predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_added_variable</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="residual-plus-component-plot" class="level3">
<h3 class="anchored" data-anchor-id="residual-plus-component-plot"><strong>Residual Plus Component Plot</strong></h3>
<p>The residual plus component plot was introduced by Ezekeil (1924). It was called as Partial Residual Plot by Larsen and McCleary (1972). Hadi and Chatterjee (2012) called it the residual plus component plot.</p>
<p>Steps to construct the plot:</p>
<ul>
<li><p>Regress <strong>Y</strong> on all variables including <strong>X</strong> and store the residuals (<strong>e</strong>).</p></li>
<li><p>Multiply <strong>e</strong> with regression coefficient of <strong>X</strong> (<strong>eX</strong>).</p></li>
<li><p>Construct scatter plot of <strong>eX</strong> and <strong>X</strong></p></li>
</ul>
<p>The residual plus component plot indicates whether any non-linearity is present in the relationship between <strong>Y</strong> and <strong>X</strong> and can suggest possible transformations for linearizing the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt <span class="sc">+</span> qsec, <span class="at">data =</span> mtcars)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_comp_plus_resid</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="a-short-introduction-to-the-blorr-package" class="level1">
<h1><strong>A Short Introduction to the blorr Package</strong></h1>
<section id="introduction-2" class="level2">
<h2 class="anchored" data-anchor-id="introduction-2"><strong>Introduction</strong></h2>
<p>The blorr package offers tools for building and validating binary logistic regression models. It is most suitable for beginner/intermediate R users and those who teach statistics using R. The API is very simple and most of the functions take either a <code>data.frame</code>/<code>tibble</code> or a <code>model</code> as input. <strong>blorr</strong> use consistent prefix <strong>blr_</strong> for easy tab completion.</p>
<section id="installation" class="level3">
<h3 class="anchored" data-anchor-id="installation"><strong>Installation</strong></h3>
<p>You can install <strong>blorr</strong> using</p>
<p>install.packages(“blorr”)</p>
</section>
<section id="libraries" class="level3">
<h3 class="anchored" data-anchor-id="libraries"><strong>Libraries</strong></h3>
<p>The following libraries are used in the examples in the vignette:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(blorr)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="bivariate-analysis" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-analysis"><strong>Bivariate Analysis</strong></h2>
<p>Let us begin with careful bivariate analysis of each possible variable and the outcome variable. We will use information value and likelihood ratio chi square test for selecting the initial set of predictors for our model. The bivariate analysis is currently avialable for categorical predictors only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_bivariate_analysis</span>(bank_marketing, y, job, marital, education, default, </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  housing, loan, contact, poutcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Bivariate Analysis                           
----------------------------------------------------------------------
Variable     Information Value    LR Chi Square    LR DF    LR p-value 
----------------------------------------------------------------------
   job             0.16              75.2690        11        0.0000   
 marital           0.05              21.6821         2        0.0000   
education          0.05              25.0466         3        0.0000   
 default           0.02              6.0405          1        0.0140   
 housing           0.16              72.2813         1        0.0000   
  loan             0.06              26.6615         1        0.0000   
 contact           0.31             124.3834         2        0.0000   
poutcome           0.53             270.6450         3        0.0000   
----------------------------------------------------------------------</code></pre>
</div>
</div>
<section id="weight-of-evidence-information-value" class="level3">
<h3 class="anchored" data-anchor-id="weight-of-evidence-information-value"><strong>Weight of Evidence &amp; Information Value</strong></h3>
<p>Weight of evidence (WoE) is used to assess the relative risk of di¤erent attributes for a characteristic and as a means to transform characteristics into variables. It is also a very useful tool for binning. The WoE for any group with average odds is zero. A negative WoE indicates that the proportion of defaults is higher for that attribute than the overall proportion and indicates higher risk.</p>
<p>The information value is used to rank order variables in terms of their predictive power. A high information value indicates a high ability to discriminate. Values for the information value will always be positive and may be above 3 when assessing highly predictive characteristics. Characteristics with information values less than 0:10 are typically viewed as weak, while values over 0.30 are sought after.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_woe_iv</span>(bank_marketing, job, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Weight of Evidence                                
--------------------------------------------------------------------------------
   levels        count_0s    count_1s    dist_0s    dist_1s        woe      iv   
--------------------------------------------------------------------------------
 management        809         130          0.20       0.25      -0.22     0.01  
 technician        682          79          0.17       0.15       0.11     0.00  
entrepreneur       139          12          0.03       0.02       0.40     0.00  
 blue-collar       937          73          0.23       0.14       0.51     0.05  
   unknown          29          2           0.01       0.00       0.61     0.00  
   retired         152          47          0.04       0.09      -0.87     0.05  
   admin.          433          61          0.11       0.12      -0.09     0.00  
  services         392          39          0.10       0.08       0.26     0.01  
self-employed      132          22          0.03       0.04      -0.26     0.00  
 unemployed        126          15          0.03       0.03       0.08     0.00  
  housemaid        110          12          0.03       0.02       0.17     0.00  
   student          63          25          0.02       0.05      -1.13     0.04  
--------------------------------------------------------------------------------

      Information Value       
-----------------------------
Variable    Information Value 
-----------------------------
  job            0.1594       
-----------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">blr_woe_iv</span>(bank_marketing, job, y)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
<section id="multiple-variables" class="level4">
<h4 class="anchored" data-anchor-id="multiple-variables"><strong>Multiple Variables</strong></h4>
<p>We can generate the weight of evidence and information value for multiple variables using <a href="https://blorr.rsquaredacademy.com/reference/blr_woe_iv_stats.html"><code>blr_woe_iv_stats()</code></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_woe_iv_stats</span>(bank_marketing, y, job, marital, education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variable: job

                               Weight of Evidence                                
--------------------------------------------------------------------------------
   levels        count_0s    count_1s    dist_0s    dist_1s        woe      iv   
--------------------------------------------------------------------------------
 management        809         130          0.20       0.25      -0.22     0.01  
 technician        682          79          0.17       0.15       0.11     0.00  
entrepreneur       139          12          0.03       0.02       0.40     0.00  
 blue-collar       937          73          0.23       0.14       0.51     0.05  
   unknown          29          2           0.01       0.00       0.61     0.00  
   retired         152          47          0.04       0.09      -0.87     0.05  
   admin.          433          61          0.11       0.12      -0.09     0.00  
  services         392          39          0.10       0.08       0.26     0.01  
self-employed      132          22          0.03       0.04      -0.26     0.00  
 unemployed        126          15          0.03       0.03       0.08     0.00  
  housemaid        110          12          0.03       0.02       0.17     0.00  
   student          63          25          0.02       0.05      -1.13     0.04  
--------------------------------------------------------------------------------

      Information Value       
-----------------------------
Variable    Information Value 
-----------------------------
  job            0.1594       
-----------------------------


Variable: marital

                            Weight of Evidence                              
---------------------------------------------------------------------------
 levels     count_0s    count_1s    dist_0s    dist_1s        woe      iv   
---------------------------------------------------------------------------
married       2467        273          0.62       0.53       0.15     0.01  
 single       1079        191          0.27       0.37      -0.32     0.03  
divorced      458          53          0.11       0.10       0.11     0.00  
---------------------------------------------------------------------------

      Information Value       
-----------------------------
Variable    Information Value 
-----------------------------
marital          0.0464       
-----------------------------


Variable: education

                             Weight of Evidence                              
----------------------------------------------------------------------------
 levels      count_0s    count_1s    dist_0s    dist_1s        woe      iv   
----------------------------------------------------------------------------
tertiary       1104        195          0.28       0.38      -0.31     0.03  
secondary      2121        231          0.53       0.45       0.17     0.01  
 unknown       154          25          0.04       0.05      -0.23     0.00  
 primary       625          66          0.16       0.13       0.20     0.01  
----------------------------------------------------------------------------

      Information Value        
------------------------------
Variable     Information Value 
------------------------------
education         0.0539       
------------------------------</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="stepwise-selection" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-selection"><strong>Stepwise Selection</strong></h2>
<p>For the initial/ first cut model, all the independent variables are put into the model. Our goal is to include a limited number of independent variables (5-15) which are all significant, without sacrificing too much on the model performance. The rationale behind not-including too many variables is that the model would be over fitted and would become unstable when tested on the validation sample. The variable reduction is done using forward or backward or stepwise variable selection procedures. We will use <a href="https://blorr.rsquaredacademy.com/reference/blr_step_aic_both.html"><code>blr_step_aic_both()</code></a> to shortlist predictors for our model.</p>
<section id="model" class="level3">
<h3 class="anchored" data-anchor-id="model"><strong>Model</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> bank_marketing, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_step_aic_both</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method 
-------------------------

Candidate Terms: 

1 . age 
2 . job 
3 . marital 
4 . education 
5 . default 
6 . balance 
7 . housing 
8 . loan 
9 . contact 
10 . day 
11 . month 
12 . duration 
13 . campaign 
14 . pdays 
15 . previous 
16 . poutcome 


Variables Entered/Removed: 

- duration added 
- poutcome added 
- month added 
- contact added 
- housing added 
- loan added 
- campaign added 
- marital added 
- education added 
- age added 

No more variables to be added or removed.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                     Stepwise Summary                      
---------------------------------------------------------
Variable      Method       AIC         BIC       Deviance 
---------------------------------------------------------
duration     addition    2674.384    2687.217    2670.384 
poutcome     addition    2396.014    2428.097    2386.014 
month        addition    2274.109    2376.773    2242.109 
contact      addition    2207.884    2323.381    2171.884 
housing      addition    2184.550    2306.463    2146.550 
loan         addition    2171.972    2300.302    2131.972 
campaign     addition    2164.164    2298.910    2122.164 
marital      addition    2158.524    2306.103    2112.524 
education    addition    2155.837    2322.666    2103.837 
age          addition    2154.272    2327.517    2100.272 
---------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_step_aic_both</span>() <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method 
-------------------------

Candidate Terms: 

1 . age 
2 . job 
3 . marital 
4 . education 
5 . default 
6 . balance 
7 . housing 
8 . loan 
9 . contact 
10 . day 
11 . month 
12 . duration 
13 . campaign 
14 . pdays 
15 . previous 
16 . poutcome 


Variables Entered/Removed: 

- duration added 
- poutcome added 
- month added 
- contact added 
- housing added 
- loan added 
- campaign added 
- marital added 
- education added 
- age added 

No more variables to be added or removed.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="regression-output" class="level2">
<h2 class="anchored" data-anchor-id="regression-output"><strong>Regression Output</strong></h2>
<section id="model-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1"><strong>Model</strong></h3>
<p>We can use bivariate analysis and stepwise selection procedure to shortlist predictors and build the model using the <a href="https://rdrr.io/r/stats/glm.html"><code>glm()</code></a>. The predictors used in the below model are for illustration purposes and not necessarily shortlisted from the bivariate analysis and variable selection procedures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span>  age <span class="sc">+</span> duration <span class="sc">+</span> previous <span class="sc">+</span> housing <span class="sc">+</span> default <span class="sc">+</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>             loan <span class="sc">+</span> poutcome <span class="sc">+</span> job <span class="sc">+</span> marital, <span class="at">data =</span> bank_marketing, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_regress</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             Model Overview                              
------------------------------------------------------------------------
Data Set    Resp Var    Obs.    Df. Model    Df. Residual    Convergence 
------------------------------------------------------------------------
  data         y        4521      4520           4498           TRUE     
------------------------------------------------------------------------

                    Response Summary                     
--------------------------------------------------------
Outcome        Frequency        Outcome        Frequency 
--------------------------------------------------------
   0             4004              1              517    
--------------------------------------------------------

                     Maximum Likelihood Estimates                       
-----------------------------------------------------------------------
   Parameter        DF    Estimate    Std. Error    z value     Pr(&gt;|z|) 
-----------------------------------------------------------------------
  (Intercept)       1     -5.1347        0.3728    -13.7729      0.0000 
      age           1      0.0096        0.0067      1.4299      0.1528 
    duration        1      0.0042         2e-04     20.7853      0.0000 
    previous        1     -0.0357        0.0392     -0.9089      0.3634 
   housingno        1      0.7894        0.1232      6.4098      0.0000 
   defaultyes       1     -0.8691        0.6919     -1.2562      0.2091 
     loanno         1      0.6598        0.1945      3.3925       7e-04 
poutcomefailure     1      0.6085        0.2012      3.0248      0.0025 
 poutcomeother      1      1.1354        0.2700      4.2057      0.0000 
poutcomesuccess     1      3.2481        0.2462     13.1913      0.0000 
 jobtechnician      1     -0.2713        0.1806     -1.5019      0.1331 
jobentrepreneur     1     -0.7041        0.3809     -1.8486      0.0645 
 jobblue-collar     1     -0.6132        0.1867     -3.2851      0.0010 
   jobunknown       1     -0.9932        0.8226     -1.2073      0.2273 
   jobretired       1      0.3197        0.2729      1.1713      0.2415 
   jobadmin.        1      0.1120        0.2001      0.5599      0.5755 
  jobservices       1     -0.1750        0.2265     -0.7728      0.4397 
jobself-employed    1     -0.1408        0.3009     -0.4680      0.6398 
 jobunemployed      1     -0.6581        0.3432     -1.9174      0.0552 
  jobhousemaid      1     -0.7456        0.3932     -1.8963      0.0579 
   jobstudent       1      0.1927        0.3433      0.5613      0.5746 
 maritalsingle      1      0.5451        0.1387      3.9299       1e-04 
maritaldivorced     1     -0.1989        0.1986     -1.0012      0.3167 
-----------------------------------------------------------------------

 Association of Predicted Probabilities and Observed Responses  
---------------------------------------------------------------
% Concordant          0.8886          Somers' D        0.7773   
% Discordant          0.1114          Gamma            0.7773   
% Tied                0.0000          Tau-a            0.1575   
Pairs                2070068          c                0.8886   
---------------------------------------------------------------</code></pre>
</div>
</div>
<p>If you want to examine the odds ratio estimates, set <code>odd_conf_limit</code> to <code>TRUE</code>. The odds ratio estimates are not explicitly computed as we observed considerable increase in computation time when dealing with large data sets.</p>
<section id="using-formula" class="level4">
<h4 class="anchored" data-anchor-id="using-formula"><strong>Using Formula</strong></h4>
<p>Let us use the model formula and the data set to generate the above results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_regress</span>(y <span class="sc">~</span>  age <span class="sc">+</span> duration <span class="sc">+</span> previous <span class="sc">+</span> housing <span class="sc">+</span> default <span class="sc">+</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>             loan <span class="sc">+</span> poutcome <span class="sc">+</span> job <span class="sc">+</span> marital, <span class="at">data =</span> bank_marketing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             Model Overview                              
------------------------------------------------------------------------
Data Set    Resp Var    Obs.    Df. Model    Df. Residual    Convergence 
------------------------------------------------------------------------
  data         y        4521      4520           4498           TRUE     
------------------------------------------------------------------------

                    Response Summary                     
--------------------------------------------------------
Outcome        Frequency        Outcome        Frequency 
--------------------------------------------------------
   0             4004              1              517    
--------------------------------------------------------

                     Maximum Likelihood Estimates                       
-----------------------------------------------------------------------
   Parameter        DF    Estimate    Std. Error    z value     Pr(&gt;|z|) 
-----------------------------------------------------------------------
  (Intercept)       1     -5.1347        0.3728    -13.7729      0.0000 
      age           1      0.0096        0.0067      1.4299      0.1528 
    duration        1      0.0042         2e-04     20.7853      0.0000 
    previous        1     -0.0357        0.0392     -0.9089      0.3634 
   housingno        1      0.7894        0.1232      6.4098      0.0000 
   defaultyes       1     -0.8691        0.6919     -1.2562      0.2091 
     loanno         1      0.6598        0.1945      3.3925       7e-04 
poutcomefailure     1      0.6085        0.2012      3.0248      0.0025 
 poutcomeother      1      1.1354        0.2700      4.2057      0.0000 
poutcomesuccess     1      3.2481        0.2462     13.1913      0.0000 
 jobtechnician      1     -0.2713        0.1806     -1.5019      0.1331 
jobentrepreneur     1     -0.7041        0.3809     -1.8486      0.0645 
 jobblue-collar     1     -0.6132        0.1867     -3.2851      0.0010 
   jobunknown       1     -0.9932        0.8226     -1.2073      0.2273 
   jobretired       1      0.3197        0.2729      1.1713      0.2415 
   jobadmin.        1      0.1120        0.2001      0.5599      0.5755 
  jobservices       1     -0.1750        0.2265     -0.7728      0.4397 
jobself-employed    1     -0.1408        0.3009     -0.4680      0.6398 
 jobunemployed      1     -0.6581        0.3432     -1.9174      0.0552 
  jobhousemaid      1     -0.7456        0.3932     -1.8963      0.0579 
   jobstudent       1      0.1927        0.3433      0.5613      0.5746 
 maritalsingle      1      0.5451        0.1387      3.9299       1e-04 
maritaldivorced     1     -0.1989        0.1986     -1.0012      0.3167 
-----------------------------------------------------------------------

 Association of Predicted Probabilities and Observed Responses  
---------------------------------------------------------------
% Concordant          0.8886          Somers' D        0.7773   
% Discordant          0.1114          Gamma            0.7773   
% Tied                0.0000          Tau-a            0.1575   
Pairs                2070068          c                0.8886   
---------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="model-fit-statistics" class="level2">
<h2 class="anchored" data-anchor-id="model-fit-statistics"><strong>Model Fit Statistics</strong></h2>
<p>Model fit statistics are available to assess how well the model fits the data and to compare two different models.The output includes likelihood ratio test, AIC, BIC and a host of pseudo r-squared measures. You can read more about pseudo r-squared at <a href="https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/" class="uri">https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/</a>.</p>
<section id="single-model" class="level4">
<h4 class="anchored" data-anchor-id="single-model"><strong>Single Model</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_model_fit_stats</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Model Fit Statistics                                
----------------------------------------------------------------------------------
Log-Lik Intercept Only:     -1607.330    Log-Lik Full Model:             -1123.340 
Deviance(4498):              2246.679    LR(22):                           967.980 
                                         Prob &gt; LR:                          0.000 
MCFadden's R2                   0.301    McFadden's Adj R2:                  0.287 
ML (Cox-Snell) R2:              0.193    Cragg-Uhler(Nagelkerke) R2:         0.379 
McKelvey &amp; Zavoina's R2:        0.388    Efron's R2:                         0.278 
Count R2:                       0.904    Adj Count R2:                       0.157 
BIC:                         2440.259    AIC:                             2292.679 
----------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="model-validation" class="level2">
<h2 class="anchored" data-anchor-id="model-validation"><strong>Model Validation</strong></h2>
<section id="confusion-matrix" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix"><strong>Confusion Matrix</strong></h3>
<p>In the event of deciding a cut-off point on the probability scores of a logistic regression model, a confusion matrix is created corresponding to a particular cut-off. The observations with probability scores above the cut-off score are predicted to be events and those below the cut-off score, as non-events. The confusion matrix, a 2X2 table, then calculates the number of correctly classified and miss-classified observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_confusion_matrix</span>(model, <span class="at">cutoff =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics 

          Reference
Prediction    0    1
         0 3920  352
         1   84  165

                Accuracy : 0.9036 
     No Information Rate : 0.8856 

                   Kappa : 0.3851 

McNemars's Test P-Value  : 0.0000 

             Sensitivity : 0.3191 
             Specificity : 0.9790 
          Pos Pred Value : 0.6627 
          Neg Pred Value : 0.9176 
              Prevalence : 0.1144 
          Detection Rate : 0.0365 
    Detection Prevalence : 0.0551 
       Balanced Accuracy : 0.6491 
               Precision : 0.6627 
                  Recall : 0.3191 

        'Positive' Class : 1</code></pre>
</div>
</div>
<p>The validity of a cut-off is measured using sensitivity, specificity and accuracy.</p>
<ul>
<li><p><strong>Sensitivity</strong>: The % of correctly classified events out of all events = TP / (TP + FN)</p></li>
<li><p><strong>Specificity</strong>: The % of correctly classified non-events out of all non-events = TN / (TN + FP)</p></li>
<li><p><strong>Accuracy</strong>: The % of correctly classified observation over all observations = (TP + TN) / (TP + FP + TN + FN)</p></li>
<li><p><em>True Positive (TP)</em> : Events correctly classified as events.</p></li>
<li><p><em>True Negative (TN)</em> : Non-Events correctly classified as non-events.</p></li>
<li><p><em>False Positive (FP)</em>: Non-events miss-classified as events.</p></li>
<li><p><em>False Negative (FN)</em>: Events miss-classified as non-events.</p></li>
</ul>
<p>For a standard logistic model, the higher is the cut-off, the lower will be the sensitivity and the higher would be the specificity. As the cut-off is decreased, sensitivity will go up, as then more events would be captured. Also, specificity will go down, as more non-events would miss-classified as events. Hence a trade-off is done based on the requirements. For example, if we are looking to capture as many events as possible, and we can afford to have miss-classified non-events, then a low cut-off is taken.</p>
</section>
<section id="hosmer-lemeshow-test" class="level3">
<h3 class="anchored" data-anchor-id="hosmer-lemeshow-test"><strong>Hosmer Lemeshow Test</strong></h3>
<p>Hosmer and Lemeshow developed a goodness-of-fit test for logistic regression models with binary responses. The test involves dividing the data into approximately ten groups of roughly equal size based on the percentiles of the estimated probabilities. The observations are sorted in increasing order of their estimated probability of having an even outcome. The discrepancies between the observed and expected number of observations in these groups are summarized by the Pearson chi-square statistic, which is then compared to chi-square distribution with t degrees of freedom, where t is the number of groups minus 2. Lower values of Goodness-of-fit are preferred.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_test_hosmer_lemeshow</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Partition for the Hosmer &amp; Lemeshow Test            
--------------------------------------------------------------
                        def = 1                 def = 0        
Group    Total    Observed    Expected    Observed    Expected 
--------------------------------------------------------------
  1       453        2          5.14        451        447.86  
  2       452        3          8.63        449        443.37  
  3       452        4         11.88        448        440.12  
  4       452        7         15.29        445        436.71  
  5       452        14        19.39        438        432.61  
  6       452        10        24.97        442        427.03  
  7       452        31        33.65        421        418.35  
  8       452        62        49.74        390        402.26  
  9       452       128        88.10        324        363.90  
 10       452       256        260.21       196        191.79  
--------------------------------------------------------------

     Goodness of Fit Test      
------------------------------
Chi-Square    DF    Pr &gt; ChiSq 
------------------------------
 52.9942      8       0.0000   
------------------------------</code></pre>
</div>
</div>
</section>
<section id="gains-table-lift-chart" class="level3">
<h3 class="anchored" data-anchor-id="gains-table-lift-chart"><strong>Gains Table &amp; Lift Chart</strong></h3>
<p>A lift curve is a graphical representation of the % of cumulative events captured at a specific cut-off. The cut-off can be a particular decile or a percentile. Similar, to rank ordering procedure, the data is in descending order of the scores and is then grouped into deciles/percentiles. The cumulative number of observations and events are then computed for each decile/percentile. The lift curve is the created using the cumulative % population as the x-axis and the cumulative percentage of events as the y-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_gains_table</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   decile total   1   0       ks  tp   tn   fp  fn sensitivity specificity
1       1   452 256 196 44.62134 256 3808  196 261    49.51644    95.10490
2       2   452 128 324 61.28765 384 3484  520 133    74.27466    87.01299
3       3   452  62 390 63.53965 446 3094  910  71    86.26692    77.27273
4       4   452  31 421 59.02130 477 2673 1331  40    92.26306    66.75824
5       5   452  10 442 49.91657 487 2231 1773  30    94.19729    55.71928
6       6   452  14 438 41.68544 501 1793 2211  16    96.90522    44.78022
7       7   452   7 445 31.92552 508 1348 2656   9    98.25919    33.66633
8       8   452   4 448 21.51040 512  900 3104   5    99.03288    22.47752
9       9   452   3 449 10.87689 515  451 3553   2    99.61315    11.26374
10     10   453   2 451  0.00000 517    0 4004   0   100.00000     0.00000
   accuracy
1  89.89162
2  85.55629
3  78.30126
4  69.67485
5  60.11944
6  50.74099
7  41.05286
8  31.23203
9  21.36695
10 11.43552</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#LiftChart</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">blr_gains_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="roc-curve" class="level3">
<h3 class="anchored" data-anchor-id="roc-curve"><strong>ROC Curve</strong></h3>
<p>ROC curve is a graphical representation of the validity of cut-offs for a logistic regression model. The ROC curve is plotted using the sensitivity and specificity for all possible cut-offs, i.e., all the probability scores. The graph is plotted using sensitivity on the y-axis and 1-specificity on the x-axis. Any point on the ROC curve represents a sensitivity X (1-specificity) measure corresponding to a cut-off. The area under the ROC curve is used as a validation measure for the model – the bigger the area the better is the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">blr_gains_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_roc_curve</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="ks-chart" class="level3">
<h3 class="anchored" data-anchor-id="ks-chart"><strong>KS Chart</strong></h3>
<p>The KS Statistic is again a measure of model efficiency, and it is created using the lift curve. The lift curve is created to plot % events. If we also plot % non-events on the same scale, with % population at x-axis, we would get another curve. The maximum distance between the lift curve for events and that for non-events is termed as KS. For a good model, KS should be big (&gt;=0.3) and should occur as close to the event rate as possible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">blr_gains_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_ks_chart</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="decile-lift-chart" class="level3">
<h3 class="anchored" data-anchor-id="decile-lift-chart"><strong>Decile Lift Chart</strong></h3>
<p>The decile lift chart displays the lift over the global mean event rate for each decile. For a model with good discriminatory power, the top deciles should have an event/conversion rate greater than the global mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_gains_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_decile_lift_chart</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="capture-rate-by-decile" class="level3">
<h3 class="anchored" data-anchor-id="capture-rate-by-decile"><strong>Capture Rate by Decile</strong></h3>
<p>If the model has good discriminatory power, the top deciles should have a higher event/conversion rate compared to the bottom deciles</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_gains_table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blr_decile_capture_rate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="lorenz-curve" class="level3">
<h3 class="anchored" data-anchor-id="lorenz-curve"><strong>Lorenz Curve</strong></h3>
<p>The Lorenz curve is a simple graphic device which illustrates the degree of inequality in the distribution of thevariable concerned. It is a visual representation of inequality used to measure the discriminatory power of the predictive model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_lorenz_curve</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Residual &amp; Influence Diagnostics</strong></p>
<p><strong>blorr</strong> can generate 22 plots for residual, influence and leverage diagnostics.</p>
<section id="influence-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="influence-diagnostics"><strong>Influence Diagnostics</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_plot_diag_influence</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Leverage Diagnostics</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_plot_diag_leverage</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fitted-values-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="fitted-values-diagnostics"><strong>Fitted Values Diagnostics</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blr_plot_diag_fit</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HWProblem2_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>